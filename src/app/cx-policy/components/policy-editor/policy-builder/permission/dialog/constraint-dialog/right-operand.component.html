<!--
 Copyright (c) 2025 Fraunhofer-Gesellschaft zur Förderung der angewandten Forschung e.V.

This program and the accompanying materials are made available under the
terms of the Apache License, Version 2.0 which is available at
https://www.apache.org/licenses/LICENSE-2.0

SPDX-License-Identifier: Apache-2.0

Contributors:
   Fraunhofer-Gesellschaft zur Förderung der angewandten Forschung e.V. - Catena-X Next Policy Builder

-->

<div class="flex flex-row items-center">
  <div class="flex-1">
    @if (selectTypes && selectTypes.length > 1) {
      <div class="join w-full">
        <label class="join-item input w-fit">
          <span class="label">Type</span>
          <select [(ngModel)]="rightOperand" (ngModelChange)="onOperandChange($event)" [compareWith]="compare">
            @for (type of selectTypes; track type.name) {
              <option [ngValue]="type">{{ camelCaseToWords(type.name) }}</option>
            }
          </select>
        </label>
        @if (rightOperand.const) {
          <input
            [type]="getOperandType()"
            class="join-item input input-bordered w-full"
            [(ngModel)]="rightOperand.const"
            disabled
          />
        } @else if (rightOperand.pattern) {
          <ng-container [formGroup]="parentFormGroup">
            <input
              [formGroup]="parentFormGroup"
              [type]="getOperandType()"
              class="w-full"
              required
              [pattern]="rightOperand.pattern"
              [formControlName]="uuid"
              [(ngModel)]="rightOperand.value"
            />
          </ng-container>
        } @else {
          <input
            [type]="getOperandType()"
            class="join-item input input-bordered w-full"
            required
            [(ngModel)]="rightOperand.value"
          />
        }
      </div>
    } @else {
      <label class="input w-full">
        <span class="label">{{ camelCaseToWords(rightOperand.name) }}</span>
        @if (rightOperand.const) {
          <input [type]="getOperandType()" class="w-full" [(ngModel)]="rightOperand.const" disabled />
        } @else if (rightOperand.pattern) {
          <ng-container [formGroup]="parentFormGroup">
            <input
              [type]="getOperandType()"
              class="w-full"
              required
              [pattern]="rightOperand.pattern"
              [formControlName]="uuid"
              [(ngModel)]="rightOperand.value"
            />
          </ng-container>
        } @else {
          <input [type]="getOperandType()" class="w-full" required [(ngModel)]="rightOperand.value" />
        }
      </label>
    }
    @if (rightOperand.pattern && parentFormGroup.get(uuid)?.invalid) {
      <p class="fieldset-label text-error pl-2">Does not match pattern: {{ rightOperand.pattern }}</p>
    }
  </div>
  @if (deleteButton) {
    <button type="button" class="ml-2 btn btn-sm btn-square btn-soft btn-error" (click)="onDelete()">
      <span class="material-symbols-rounded">delete</span>
    </button>
  }
</div>
